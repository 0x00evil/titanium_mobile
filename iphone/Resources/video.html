<html>
<head>
<script>
	window.onload = function()
	{
		Titanium.API.info("Très 漢字");
		
		document.getElementById("s").addEventListener('click',function()
		{
			var sound = Titanium.Media.createSound("song.mp3");
			sound.play();
		});
		
		document.getElementById("ss").addEventListener('click',function()
		{
			Titanium.Media.takeScreenshot(function(media)
			{
				document.getElementById('i').src = media.url;
				Titanium.Media.saveToPhotoGallery(media);
			});
		});
		
		var movieUrl = 'movie.m4v';
		
		var doMediaThing = function(media,details,image){
			var activeMovie = Titanium.Media.createVideoPlayer({
							contentURL:movieUrl, //media.url,
							backgroundColor:'#111',
							movieControlMode:Titanium.Media.VIDEO_CONTROL_DEFAULT,
							scalingMode:Titanium.Media.VIDEO_SCALING_MODE_FILL
			});
			activeMovie.addEventListener('complete',function()
			{
					Ti.API.info("video completed");
			});

			document.getElementById("mediatype").innerHTML = details.mediaType;
			
			if(image){
				document.getElementById('i').src = image.url;
				
				Titanium.Media.saveToPhotoGallery(image.url);
			}
			activeMovie.stop();
			activeMovie.play();	
		};
		
		document.getElementById("pl").addEventListener('click',function()
		{
			doMediaThing(null,{mediaType:'fake'},null);
		});

		document.getElementById("b").addEventListener('click',function()
		{
			Titanium.Media.showCamera({
//			Titanium.Media.openPhotoGallery({
				success:function(media,details,image){movieUrl=media.url;
					window.setTimeout(doMediaThing,100,media,details,image);},
				cancel:function()
				{
				},
				error:function()
				{
				},
				animated:false,
				allowImageEditing:true,
				mediaTypes: [Titanium.Media.MEDIA_TYPE_VIDEO],
				videoMaximumDuration:10000,
				videoQuality:Titanium.Media.QUALITY_HIGH
			});
		});
	};
</script>
</head>
<body>
<div style="margin-top:100px;width:300px;margin:auto;"><button id="b" style="font-size:24px;">Make video</button></div>
<div style="margin-top:100px;width:300px;margin:auto;"><button id="s" style="font-size:24px;">Play sound</button></div>
<div style="margin-top:100px;width:300px;margin:auto;"><button id="ss" style="font-size:24px;">Take Screenshot</button></div>
<div style="margin-top:100px;width:300px;margin:auto;"><button id="pl" style="font-size:24px;">Play video</button></div>
<div id="mediatype"></div>
<div><img id="i" width="100" height="100"/></div>
</body>
</html>